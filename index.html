<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Programme Escalade ‚Äî App</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Escalade Trainer">
<link rel="icon" href="icon-192.png">

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
/* --- Styles (inchang√©s / modernis√©s) --- */
body{font-family:'Inter',sans-serif;margin:0;padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);background:linear-gradient(135deg,#0f172a 0%,#1e293b 100%);color:#f8fafc;min-height:100vh;display:flex;flex-direction:column;align-items:center;}
h1{font-weight:700;font-size:1.8em;margin:1em 0 0.5em;color:#a5b4fc;text-align:center;letter-spacing:1px;}
h2{font-size:1.15em;color:#c7d2fe;margin:0 0 .6em 0;}
.card{width:90%;max-width:700px;background:rgba(15,23,42,0.85);border:1px solid rgba(99,102,241,0.16);border-radius:14px;margin:12px 0;padding:16px;box-shadow:0 6px 24px rgba(0,0,0,0.28);backdrop-filter:blur(8px);}
ul{list-style:none;padding:0;margin:0;}
li{padding:10px 8px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid rgba(255,255,255,0.06);cursor:pointer;transition:background .15s;}
li:hover{background:rgba(99,102,241,0.10);}
button{padding:8px 12px;border-radius:8px;border:none;background:linear-gradient(90deg,#6366f1,#8b5cf6);color:#fff;font-weight:600;cursor:pointer;transition:transform .12s;}
button:hover{transform:scale(1.03);}
.reset-btn{background:linear-gradient(90deg,#ef4444,#f87171);}
#timer_display{font-size:1.8em;font-weight:700;color:#a5b4fc;}
.progress-container{background:rgba(255,255,255,0.07);height:12px;border-radius:10px;width:100%;overflow:hidden;margin-top:6px;}
.progress-bar{height:12px;background:linear-gradient(90deg,#6366f1,#8b5cf6);width:0%;transition:width .4s;border-radius:10px;}
.day{padding:12px;border-radius:10px;background:rgba(255,255,255,0.03);margin:8px 0;}
.day h3{margin:0;display:flex;justify-content:space-between;font-weight:600;}
.day-details{max-height:0;overflow:hidden;opacity:0;transition:all .45s cubic-bezier(.25,.8,.25,1);}
.day-details.open{max-height:400px;opacity:1;margin-top:8px;}
.exercise-page{display:none;width:92%;max-width:900px;flex-direction:column;align-items:center;animation:fadeIn .35s;}
.exercise-page.active{display:flex;}
.exercise-page iframe{width:100%;height:380px;border-radius:12px;border:none;margin-bottom:14px;}
.back-btn{align-self:flex-start;margin-bottom:12px;background:linear-gradient(90deg,#6366f1,#8b5cf6);padding:8px 10px;border-radius:8px;border:none;color:#fff;font-weight:600;cursor:pointer;}
.small-muted{color:#e6eef8;opacity:.85;margin-bottom:8px;}
.tips li{margin:6px 0;padding-left:8px;}
footer{margin-top:auto;padding:12px;font-size:.9em;opacity:.6;}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>
<h1>üèîÔ∏è Programme Escalade & Musculation</h1>

<div id="main_page">
  <div class="card">
    <h2>üóìÔ∏è Calendrier</h2>
    <div id="calendar"></div>
  </div>

  <div class="card" id="daily_session_card">
    <h2 id="session_title">üí™ S√©ance du jour</h2>
    <ul id="session_list"></ul>
    <button class="reset-btn" onclick="resetSeries()">üîÑ Reset s√©ries</button>
    <button style="margin-top:10px;" onclick="markSessionDone()">‚úÖ S√©ance termin√©e</button>
  </div>

  <div class="card" id="progress_card">
    <h2>üìà Progression</h2>
    <p>Semaine : <span id="week_progress_text"></span></p>
    <div class="progress-container"><div class="progress-bar" id="week_progress_bar"></div></div>
    <p style="margin-top:8px;">Mois : <span id="month_progress_text"></span></p>
    <div class="progress-container"><div class="progress-bar" id="month_progress_bar"></div></div>
    <p style="margin-top:12px;">üî• Streak : <span id="streak_value">0</span> jours cons√©cutifs</p>
  </div>

  <div class="card">
    <h2>‚è±Ô∏è Minuteur global</h2>
    <p id="timer_display">00:00</p>
    <div>
      <button onclick="startTimer()">‚ñ∂ Start</button>
      <button onclick="stopTimer()">‚è∏ Stop</button>
      <button onclick="resetTimer()" class="reset-btn">üîÅ Reset</button>
    </div>
  </div>
</div>

<!-- Page D√©tail Exercice -->
<div id="exercise_page" class="exercise-page" role="region" aria-label="D√©tail exercice">
  <button class="back-btn" onclick="goBack()">‚¨Ö Retour</button>
  <h2 id="exo_title"></h2>
  <iframe id="exo_video" src="" allowfullscreen title="Vid√©o exercice"></iframe>
  <p id="exo_desc" class="small-muted"></p>
  <ul id="exo_tips" class="tips"></ul>
</div>

<footer>¬© 2025 L√©o EGGENSCHWILLER ‚Ä¢ Stay Strong üí•</footer>

<script>
/* ============================
   Donn√©es d'exercices (toutes les exercises actives remplies)
   Chaque entr√©e contient : video (embed URL), desc, tips[]
   J'ai choisi des vid√©os p√©dagogiques / tutorials YouTube publiques.
   Sources principales list√©es dans la r√©ponse.
   ============================ */
const exerciseData = {
  "Pompes lest√©es si possible ‚Äî 4√ó10-12": {
    video: "https://www.youtube.com/embed/xZRBXI7we44",
    desc: "Pompes avec charge additionnelle pour surcharger le mouvement horizontal et d√©velopper la force du haut du corps. Ma√Ætrise les pompes strictes avant d'ajouter du poids.",
    tips: ["Garde la colonne neutre (gainage).", "Coudes ~45¬∞ pour prot√©ger les √©paules.", "Ajoute du poids progressivement (sac √† dos, plaque)."]
  },
  "Planche ‚Äî 4√ó40s": {
    video: "https://www.youtube.com/embed/pSHjTRCQxIw",
    desc: "Gainage frontal pour la stabilit√© du tronc ‚Äî essentiel pour garder le corps proche de la paroi en escalade.",
    tips: ["Ne creuse pas le bas du dos.", "Contracte fessiers et abdos.", "Respire calmement et maintiens la position."]
  },
  "Dips sur chaise ‚Äî 4√ó12": {
    video: "https://www.youtube.com/embed/0326dy_-CzM",
    desc: "Dips sur chaise / banc : bonne alternative maison pour les triceps et la partie basse des pectoraux.",
    tips: ["Garde les √©paules basses et le buste droit.", "Coudes pr√®s du corps pour engager les triceps.", "Si douleur, r√©duis amplitude ou remplace."]
  },
  "Tractions australiennes ou sur barre ‚Äî 4√ó6-10": {
    video: "https://www.youtube.com/embed/bHO0A4ZF_Zg",
    desc: "Row invers√© / Australian pull-up : excellent pour progresser vers les tractions compl√®tes et renforcer le dos pour l'escalade.",
    tips: ["Corps gain√©, talons au sol.", "Tire la poitrine vers la barre.", "Contr√¥le la descente (phase excentrique)."]
  },
  "Suspension sur prises maison ‚Äî 4√ó20s": {
    video: "https://www.youtube.com/embed/yUIRzwyQx_E",
    desc: "Travail de suspension (hangs) pour renforcer les doigts et l'avant-bras. Attention aux tendons si tu d√©butes ‚Äî √©chauffe sp√©cifique.",
    tips: ["Commence par prises grandes √† deux mains.", "√âvite les holds maximales si peu d'exp√©rience.", "Fais des s√©ries courtes, progresse lentement."]
  },
  "Rowing invers√© sous table ‚Äî 4√ó10": {
    video: "https://www.youtube.com/embed/5W8F6MzZ8Rk",
    desc: "Rowing sous table : alternative maison au rowing pour d√©velopper le dos quand on n'a pas de barre.",
    tips: ["V√©rifie la stabilit√© de la table.", "Reste align√© de la t√™te aux talons.", "Rehausse les pieds pour augmenter la difficult√©."]
  },
  "Squats ‚Äî 4√ó15": {
    video: "https://www.youtube.com/embed/aclHkVaku9U",
    desc: "Mouvement fondamental pour force et explosivit√© des jambes ‚Äî utile pour pousser sur les appuis et la stabilit√©.",
    tips: ["Pousse avec les talons.", "Genoux align√©s sur la m√™me ligne que les orteils.", "Garde la poitrine fi√®re, regarde l√©g√®rement vers l'avant."]
  },
  "Fentes avant ‚Äî 4√ó12": {
    video: "https://www.youtube.com/embed/2C-uNgKwPLE",
    desc: "Fentes pour force unilat√©rale, √©quilibre et coordination ‚Äî bon pour corriger les d√©s√©quilibres entre jambes.",
    tips: ["Torso droit, genou avant au-dessus du pied.", "Descend contr√¥l√© et pousse fort pour remonter.", "Alterne jambes pour sym√©trie."]
  },
  "Mont√©es de genoux dynamiques ‚Äî 4√ó30s": {
    video: "https://www.youtube.com/embed/8oB3z3TqC3Y",
    desc: "Exercice pliom√©trique pour explosivit√©, cardio et coordination (bon √©chauffement actif).",
    tips: ["Mouvement explosif mais contr√¥l√©.", "Maintiens cadence r√©guli√®re.", "√âchauffe bien avant de commencer."]
  },
  "Pompes serr√©es ‚Äî 4√ó12": {
    video: "https://www.youtube.com/embed/mzhpUO64N6Q",
    desc: "Pompes en prise serr√©e pour cibler triceps et la stabilit√© du tronc ‚Äî utile pour les verrouillages sur petits d√©placements.",
    tips: ["Mains proches sous la poitrine.", "Garde coudes pr√®s du corps.", "Progression : pieds sur√©lev√©s pour plus d'intensit√©."]
  },
  "Suspension 3 doigts ‚Äî 4√ó12s": {
    video: "https://www.youtube.com/embed/PebF3NyEGPc",
    desc: "Exercices sp√©cifiques doigts (3 doigts) pour d√©velopper la force de pr√©hension ‚Äî fais tr√®s attention aux signaux de douleur tendineuse.",
    tips: ["√âchauffe des doigts avant toute suspension.", "Commence tr√®s l√©ger et augmente graduellement.", "Privil√©gie la qualit√© sur la dur√©e."]
  },
  "Gainage lat√©ral ‚Äî 4√ó40s / c√¥t√©": {
    video: "https://www.youtube.com/embed/2lP9qf8cD3s",
    desc: "Travail des obliques et de la stabilit√© lat√©rale, utile pour la gestion des d√©s√©quilibres en escalade.",
    tips: ["√âpaule empil√©e sur la hanche.", "Corps align√© t√™te/√©paules/hanches/genoux.", "Augmente le temps progressivement."]
  },
  "Tractions australiennes ‚Äî 4√ó10": { // duplicate but explicit
    video: "https://www.youtube.com/embed/bHO0A4ZF_Zg",
    desc: "Version pour travailler le tirage. Tr√®s utile en renforcement pour l'escalade.",
    tips: ["Contracte le dos en tirant.", "Maintiens corps droit.", "Contr√¥le la descente."]
  },
  "Crunchs ‚Äî 4√ó20": {
    video: "https://www.youtube.com/embed/1fbU_MkV7NE",
    desc: "Renforcement des abdominaux sup√©rieurs ; √† combiner avec le gainage pour un tronc complet.",
    tips: ["Ne tire pas sur la nuque.", "Concentre la contraction sur le ventre.", "Varie avec gainage pour un travail complet."]
  },
  "Planche lat√©rale ‚Äî 4√ó40s": {
    video: "https://www.youtube.com/embed/2lP9qf8cD3s",
    desc: "Variante du gainage pour travailler les obliques et la stabilit√© en rotation.",
    tips: ["Respire r√©guli√®rement.", "√âpaule stable et corps align√©.", "Ajoute une variation (√©l√©vation jambe) pour progresser."]
  }
};

/* ============================
   Programme hebdomadaire
   ============================ */
const programme = {
  Lundi: { title: "Pouss√©e + Core", ex: ["Pompes lest√©es si possible ‚Äî 4√ó10-12", "Planche ‚Äî 4√ó40s", "Dips sur chaise ‚Äî 4√ó12"] },
  Mardi: { title: "Tirage + Grip", ex: ["Tractions australiennes ou sur barre ‚Äî 4√ó6-10", "Suspension sur prises maison ‚Äî 4√ó20s", "Rowing invers√© sous table ‚Äî 4√ó10"] },
  Mercredi: { title: "Jambes + Explosivit√©", ex: ["Squats ‚Äî 4√ó15", "Fentes avant ‚Äî 4√ó12", "Mont√©es de genoux dynamiques ‚Äî 4√ó30s"] },
  Jeudi: { title: "Haut du corps + Doigts", ex: ["Pompes serr√©es ‚Äî 4√ó12", "Suspension 3 doigts ‚Äî 4√ó12s", "Gainage lat√©ral ‚Äî 4√ó40s / c√¥t√©"] },
  Vendredi: { title: "Tirage + Core", ex: ["Tractions australiennes ‚Äî 4√ó10", "Crunchs ‚Äî 4√ó20", "Planche lat√©rale ‚Äî 4√ó40s"] },
  Samedi: { title: "Repos actif", ex: ["√âtirements", "Mobilit√©", "Yoga doux"] },
  Dimanche: { title: "Repos total", ex: ["Hydratation", "Pr√©paration semaine", "Sieste üòå"] }
};

/* ============================
   Calendrier (g√©n√©ration + toggle repar√©)
   ============================ */
const calendar = document.getElementById('calendar');
const todayName = new Date().toLocaleDateString('fr-FR', { weekday: 'long' });

for (const [day, data] of Object.entries(programme)) {
  const d = document.createElement('div');
  d.className = 'day';
  d.innerHTML = `<h3>${day} <span style="font-size:.9em;opacity:.75;">${data.title}</span></h3>
                 <div class="day-details">
                   <ul>${data.ex.map(e=>`<li class="day-exercise">${e}</li>`).join('')}</ul>
                 </div>`;
  calendar.appendChild(d);
}
// toggle details
calendar.addEventListener('click', (e)=>{
  const dayEl = e.target.closest('.day');
  if(!dayEl) return;
  const details = dayEl.querySelector('.day-details');
  const open = details.classList.contains('open');
  document.querySelectorAll('.day-details').forEach(d=>d.classList.remove('open'));
  if(!open) details.classList.add('open');
});

/* ============================
   S√©ance du jour (cliquable)
   ============================ */
const sessionList = document.getElementById('session_list');
const titleEl = document.getElementById('session_title');
const todayKey = todayName.charAt(0).toUpperCase() + todayName.slice(1);
const todayData = programme[todayKey];

function makeExerciseClickable(li, exName){
  li.addEventListener('click', ()=> openExercise(exName));
}

if(todayData){
  titleEl.textContent = `üí™ S√©ance du jour (${todayData.title})`;
  todayData.ex.forEach(ex=>{
    const li = document.createElement('li');
    li.textContent = ex;
    sessionList.appendChild(li);
    makeExerciseClickable(li, ex);
  });
} else {
  titleEl.textContent = "üòå Jour de repos / √©tirements";
  sessionList.innerHTML = "<li>Profite pour r√©cup√©rer et t‚Äô√©tirer !</li>";
}

// rendre les exos dans le calendrier cliquables (sans toggler la journ√©e)
document.querySelectorAll('.day-exercise').forEach(el=>{
  const exName = el.textContent;
  el.style.cursor = 'pointer';
  el.addEventListener('click', (ev)=>{
    ev.stopPropagation(); // emp√™che toggle de la journ√©e
    openExercise(exName);
  });
});

/* ============================
   Navigation vers la page exercice
   ============================ */
function openExercise(exName){
  const exo = exerciseData[exName];
  if(!exo){
    alert("Aucune donn√©e pour cet exercice ‚Äî je peux l'ajouter si tu veux.");
    return;
  }
  document.getElementById("main_page").style.display = "none";
  const ep = document.getElementById("exercise_page");
  ep.classList.add("active");
  document.getElementById("exo_title").textContent = exName;
  document.getElementById("exo_video").src = exo.video;
  document.getElementById("exo_desc").textContent = exo.desc;
  document.getElementById("exo_tips").innerHTML = exo.tips.map(t=>`<li>üí° ${t}</li>`).join('');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
function goBack(){
  document.getElementById("exercise_page").classList.remove("active");
  document.getElementById("main_page").style.display = "block";
  document.getElementById("exo_video").src = "";
}

/* ============================
   Progression & Timer (inchang√© mais fonctionnel)
   ============================ */
function markSessionDone(){
  const today = new Date().toISOString().split('T')[0];
  let history = JSON.parse(localStorage.getItem('sessions_done')||'[]');
  if(!history.includes(today)){
    history.push(today);
    localStorage.setItem('sessions_done', JSON.stringify(history));
  }
  updateProgress();
}
function updateProgress(){
  const history = JSON.parse(localStorage.getItem('sessions_done')||'[]');
  const today = new Date();
  // week number (simple)
  const yearWeek = (d=>{
    const oneJan=new Date(d.getFullYear(),0,1);
    const numberOfDays=Math.floor((d-oneJan)/(24*60*60*1000));
    return Math.ceil((numberOfDays + oneJan.getDay()+1)/7);
  })(today);

  const weekSessions = history.filter(date=>{
    const d = new Date(date);
    const week = (d=>{
      const oneJan = new Date(d.getFullYear(),0,1);
      const numberOfDays = Math.floor((d-oneJan)/(24*60*60*1000));
      return Math.ceil((numberOfDays + oneJan.getDay()+1)/7);
    })(d);
    return week === yearWeek;
  }).length;

  const weekProgress = Math.min((weekSessions/5)*100,100);
  document.getElementById('week_progress_bar').style.width = weekProgress+'%';
  document.getElementById('week_progress_text').textContent = `${weekSessions}/5 s√©ances`;

  // month
  const month = today.getMonth();
  const monthSessions = history.filter(date => new Date(date).getMonth() === month).length;
  const monthDays = new Date(today.getFullYear(), month+1,0).getDate();
  const monthProgress = Math.min((monthSessions/(monthDays/2))*100,100);
  document.getElementById('month_progress_bar').style.width = monthProgress+'%';
  document.getElementById('month_progress_text').textContent = `${monthSessions} s√©ances`;

  // streak
  let streak = 0;
  let checkDate = new Date(today);
  while(history.includes(checkDate.toISOString().split('T')[0])){
    streak++;
    checkDate.setDate(checkDate.getDate()-1);
  }
  document.getElementById('streak_value').textContent = streak;
}
updateProgress();

/* Timer */
let timerInterval;
let timerSeconds = parseInt(localStorage.getItem('timerSeconds')||'0',10)||0;
const display = document.getElementById('timer_display');
function updateDisplay(){ let m=Math.floor(timerSeconds/60), s=timerSeconds%60; display.textContent = `${m<10?'0':''}${m}:${s<10?'0':''}${s}`; }
updateDisplay();
function startTimer(){ if(timerInterval) return; timerInterval = setInterval(()=>{ timerSeconds++; localStorage.setItem('timerSeconds', timerSeconds); updateDisplay(); },1000); }
function stopTimer(){ clearInterval(timerInterval); timerInterval=null; }
function resetTimer(){ timerSeconds=0; updateDisplay(); localStorage.removeItem('timerSeconds'); }

/* Placeholder reset s√©ries */
function resetSeries(){ alert("Reset s√©ries : impl√©mente ici ta logique de s√©ries si besoin."); }

</script>
</body>
</html>
