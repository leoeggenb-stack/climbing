<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Programme Escalade ‚Äî App</title>
<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Escalade Trainer">
<link rel="apple-touch-icon" href="icon-192.png">

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
body { font-family: 'Inter', sans-serif; margin: 0; padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left); background: linear-gradient(135deg,#0f172a 0%,#1e293b 100%); color:#f8fafc; min-height:100vh; display:flex; flex-direction:column; align-items:center; }
h1{ text-align:center; font-weight:700; font-size:1.8em; margin:1em 0 0.5em 0; color:#a5b4fc; letter-spacing:1px; }
h2{ font-size:1.2em; margin-bottom:0.4em; color:#c7d2fe; }
.card{ width:90%; max-width:500px; background:rgba(15,23,42,0.8); border:1px solid rgba(99,102,241,0.2); border-radius:14px; margin:12px 0; padding:16px; box-shadow:0 4px 20px rgba(0,0,0,0.25); backdrop-filter: blur(10px); animation:fadeIn 0.6s ease; }
ul{ list-style:none; padding-left:0; margin:0; }
li{ padding:8px 0; display:flex; align-items:center; justify-content:space-between; border-bottom:1px solid rgba(255,255,255,0.1); cursor:pointer; transition:background 0.2s; }
li:hover{ background: rgba(99,102,241,0.12); }
li:last-child{ border-bottom:none; }
button{ padding:6px 12px; margin-left:8px; border-radius:8px; border:none; background:linear-gradient(90deg,#6366f1,#8b5cf6); color:#fff; font-weight:600; cursor:pointer; transition:transform .15s ease, opacity .15s ease; }
button:hover{ transform:scale(1.05); opacity:0.95; }
.reset-btn{ background:linear-gradient(90deg,#ef4444,#f87171); margin-top:10px; }
#timer_display{ font-size:2em; font-weight:bold; color:#a5b4fc; letter-spacing:1px; }
.progress-container{ background:rgba(255,255,255,0.1); border-radius:10px; height:12px; width:100%; overflow:hidden; margin-top:6px; }
.progress-bar{ height:12px; background:linear-gradient(90deg,#6366f1,#8b5cf6); width:0%; transition:width .4s ease; border-radius:10px; }
footer{ margin-top:auto; padding:12px; font-size:.9em; opacity:.6; }
.day{ padding:10px; margin:6px 0; border-radius:8px; background:rgba(255,255,255,0.05); cursor:pointer; transition:background .3s; }
.day:hover{ background:rgba(99,102,241,0.15); }
.day h3{ margin:0; display:flex; justify-content:space-between; font-weight:600; }
.day-details{ max-height:0; overflow:hidden; opacity:0; transition:all .45s cubic-bezier(.25,.8,.25,1); }
.day-details.open{ max-height:400px; opacity:1; margin-top:8px; }
.exercise-page{ display:none; width:90%; max-width:700px; flex-direction:column; align-items:center; animation:fadeIn .5s ease; }
.exercise-page iframe{ width:100%; height:350px; border-radius:12px; margin-bottom:16px; border:none; }
.exercise-page.active{ display:flex; }
.back-btn{ align-self:flex-start; margin-bottom:12px; background:linear-gradient(90deg,#6366f1,#8b5cf6); }
@keyframes fadeIn{ from{ opacity:0; transform:translateY(8px);} to{ opacity:1; transform:translateY(0);} }
.small-muted{ font-size:0.85em; opacity:0.8; }
</style>
</head>
<body>
<h1>üèîÔ∏è Programme Escalade & Musculation</h1>

<div id="main_page">
  <div class="card">
    <h2>üóìÔ∏è Calendrier</h2>
    <div id="calendar"></div>
  </div>

  <div class="card" id="daily_session_card">
    <h2 id="session_title">üí™ S√©ance du jour</h2>
    <ul id="session_list"></ul>
    <button class="reset-btn" onclick="reset()">üîÑ Reset s√©ries</button>
    <button style="margin-top:10px;" onclick="markSessionDone()">‚úÖ S√©ance termin√©e</button>
  </div>

  <div class="card" id="progress_card">
    <h2>üìà Progression</h2>
    <p>Semaine : <span id="week_progress_text"></span></p>
    <div class="progress-container"><div class="progress-bar" id="week_progress_bar"></div></div>
    <p style="margin-top:8px;">Mois : <span id="month_progress_text"></span></p>
    <div class="progress-container"><div class="progress-bar" id="month_progress_bar"></div></div>
    <p style="margin-top:12px;">üî• Streak : <span id="streak_value">0</span> jours cons√©cutifs</p>
  </div>

  <div class="card">
    <h2>‚è±Ô∏è Minuteur global</h2>
    <p><span id="timer_display">00:00</span></p>
    <div>
      <button onclick="startTimer()">‚ñ∂ Start</button>
      <button onclick="stopTimer()">‚è∏ Stop</button>
      <button onclick="resetTimer()" class="reset-btn">üîÅ Reset</button>
    </div>
  </div>
</div>

<!-- Page D√©tail Exercice -->
<div id="exercise_page" class="exercise-page" role="region" aria-label="D√©tail exercice">
  <button class="back-btn" onclick="goBack()">‚¨Ö Retour</button>
  <h2 id="exo_title"></h2>
  <iframe id="exo_video" src="" allowfullscreen title="Vid√©o exercice"></iframe>
  <p id="exo_desc" class="small-muted"></p>
  <ul id="exo_tips"></ul>
</div>

<footer>¬© 2025 Escalade Trainer ‚Ä¢ Stay Strong üí•</footer>

<script>
// ------------ donn√©es des exercices (vid√©os + descriptions + conseils) ------------
// J'ai s√©lectionn√© des tutoriels YouTube de cha√Ænes reconnues / guides pratiques.
// Sources exemples : tutoriels weighted pushups, planks, inverted rows, dips, hangboarding.
// (Voir message assistant pour citations.)
const exerciseData = {
  "Pompes lest√©es si possible ‚Äî 4√ó10-12": {
    video: "https://www.youtube.com/embed/xZRBXI7we44",
    desc: "Pompes avec charge additionnelle pour augmenter la force du haut du corps. Progression importante : ma√Ætriser les pompes strictes avant d'ajouter du poids.",
    tips: ["Garde le corps align√© (planche solide).", "Elbows ~45¬∞ pour prot√©ger les √©paules.", "Ajoute du poids progressivement (sac ou plaque)."]
  },
  "Planche ‚Äî 4√ó40s": {
    video: "https://www.youtube.com/embed/pSHjTRCQxIw",
    desc: "Gainage frontal pour la stabilit√© du tronc ‚Äî utile en escalade pour garder le corps proche de la paroi.",
    tips: ["Ne creuse pas le bas du dos.", "Regarde le sol, serrer les fessiers.", "Respire calmement, maintien constant."]
  },
  "Dips sur chaise ‚Äî 4√ó12": {
    video: "https://www.youtube.com/embed/c3ZGl4pAwZ4",
    desc: "Dips sur banc/chaise pour travailler triceps et partie basse des pectoraux ‚Äî adaptation maison simple.",
    tips: ["Descends sans creuser les √©paules.", "Garde les coudes pr√®s du buste.", "Si douleur √† l'√©paule : stop et remplace par extensions triceps."]
  },
  "Tractions australiennes ou sur barre ‚Äî 4√ó6-10": {
    video: "https://www.youtube.com/embed/5W8F6MzZ8Rk",
    desc: "Row invers√© / Australian pull-up : progression vers les tractions, tr√®s utile pour le tirage en escalade.",
    tips: ["Corps bien gain√©, talons au sol.", "Tire la poitrine vers la barre.", "Contr√¥le la phase excentrique."]
  },
  "Suspension sur prises maison ‚Äî 4√ó20s": {
    video: "https://www.youtube.com/embed/yUIRzwyQx_E",
    desc: "Exercices de suspension / fingerboard pour travailler la force des doigts (attention aux tendons si d√©butant).",
    tips: ["Commence par suspensions √† deux mains sur bords grands.", "Evite les hangs maximums si <1 an d'escalade.", "Echauffe sp√©cifique avant toute session de doigts."]
  },
  "Rowing invers√© sous table ‚Äî 4√ó10": {
    video: "https://www.youtube.com/embed/bHO0A4ZF_Zg",
    desc: "Rowing sous table = alternative maison pour travailler le dos si tu n'as pas de barre.",
    tips: ["V√©rifie que la table est stable.", "Garde ligne droite du corps.", "Progression : √©l√®ve les pieds pour plus de difficult√©."]
  },
  "Squats ‚Äî 4√ó15": {
    video: "https://www.youtube.com/embed/aclHkVaku9U",
    desc: "Mouvement de base pour jambes et explosivit√©, fais attention √† la profondeur selon ta mobilit√©.",
    tips: ["Genoux align√©s avec les orteils.", "Regarde l√©g√®rement en avant.", "Pousse avec les talons."]
  },
  "Fentes avant ‚Äî 4√ó12": {
    video: "https://www.youtube.com/embed/2C-uNgKwPLE",
    desc: "Fentes pour √©quilibre unilat√©ral et force fonctionnelle.",
    tips: ["Torso droit, genou avant au-dessus du pied.", "Descend contr√¥l√©.", "Alternes jambes pour sym√©trie."]
  },
  "Mont√©es de genoux dynamiques ‚Äî 4√ó30s": {
    video: "https://www.youtube.com/embed/8oB3z3TqC3Y",
    desc: "Exercice pliom√©trique pour explosivit√© et coordination.",
    tips: ["Mouvement explosif mais contr√¥l√©.", "Garde cadence r√©guli√®re.", "Bon √©chauffement pr√©alable."]
  },
  "Pompes serr√©es ‚Äî 4√ó12": {
    video: "https://www.youtube.com/embed/mzhpUO64N6Q",
    desc: "Pompes prise serr√©e ciblent triceps et cha√Æne m√©diane ‚Äî utile pour verrouillage sur blocs.",
    tips: ["Mains proches sous la poitrine.", "Maintien neutre du poignet.", "Progression : pieds sur√©lev√©s."]
  },
  "Suspension 3 doigts ‚Äî 4√ó12s": {
    video: "https://www.youtube.com/embed/PebF3NyEGPc",
    desc: "Suspensions sur prises petites (3 doigts) pour force sp√©cifique doigts ‚Äî avance prudemment.",
    tips: ["Ne pas forcer si douleur aux tendons.", "Privil√©gie suspensions courtes et r√©p√©t√©s.", "Renforce graduellement la difficult√©."]
  },
  "Gainage lat√©ral ‚Äî 4√ó40s / c√¥t√©": {
    video: "https://www.youtube.com/embed/2lP9qf8cD3s",
    desc: "Stabilit√© lat√©rale importante pour positionnement du corps sur d√©vers.",
    tips: ["Epaule empil√©e sur la hanche.", "Garde corps align√©.", "Augmente le temps progressivement."]
  },
  "Crunchs ‚Äî 4√ó20": {
    video: "https://www.youtube.com/embed/1fbU_MkV7NE",
    desc: "Renforcement abdos sup√©rieurs, utile pour la stabilit√© abdominale.",
    tips: ["Ne tire pas avec la nuque.", "Concentre la contraction sur le ventre.", "Varie avec gainage pour √©quilibre."]
  },
  "Planche lat√©rale ‚Äî 4√ó40s": {
    video: "https://www.youtube.com/embed/2lP9qf8cD3s",
    desc: "Variante du gainage pour obliques et stabilit√© en torsion.",
    tips: ["Respire pendant le maintien.", "Soutiens ton poids sur l'avant-bras.", "Ajoute √©l√©vation de jambe pour progression."]
  },
  "√âtirements": { video: "https://www.youtube.com/embed/8TG6X3e3qjY", desc: "S√©quence d'√©tirements post-entra√Ænement.", tips: ["Maintiens 30s par muscle.", "Ne rebondis pas.", "Respire profond√©ment."] },
  "Mobilit√©": { video: "https://www.youtube.com/embed/2pLT-olgUJs", desc: "Mobilit√© et mouvements articulaires pour pr√©paration.", tips: ["Focus hanches/√©paules.", "Fais-le en d√©but ou fin de s√©ance.", "Progression douce."] },
  "Hydratation": { video: "https://www.youtube.com/embed/dQw4w9WgXcQ", desc: "Rappel hydratation (vid√©o illustrative).", tips: ["Bois r√©guli√®rement.", "√âvite boissons sucr√©es pendant la s√©ance."] }
};

// ------------ programme hebdomadaire ------------
const programme = {
  Lundi: { title: "Pouss√©e + Core", ex: ["Pompes lest√©es si possible ‚Äî 4√ó10-12", "Planche ‚Äî 4√ó40s", "Dips sur chaise ‚Äî 4√ó12"] },
  Mardi: { title: "Tirage + Grip", ex: ["Tractions australiennes ou sur barre ‚Äî 4√ó6-10", "Suspension sur prises maison ‚Äî 4√ó20s", "Rowing invers√© sous table ‚Äî 4√ó10"] },
  Mercredi: { title: "Jambes + Explosivit√©", ex: ["Squats ‚Äî 4√ó15", "Fentes avant ‚Äî 4√ó12", "Mont√©es de genoux dynamiques ‚Äî 4√ó30s"] },
  Jeudi: { title: "Haut du corps + Doigts", ex: ["Pompes serr√©es ‚Äî 4√ó12", "Suspension 3 doigts ‚Äî 4√ó12s", "Gainage lat√©ral ‚Äî 4√ó40s / c√¥t√©"] },
  Vendredi: { title: "Tirage + Core", ex: ["Tractions australiennes ‚Äî 4√ó10", "Crunchs ‚Äî 4√ó20", "Planche lat√©rale ‚Äî 4√ó40s"] },
  Samedi: { title: "Repos actif", ex: ["√âtirements", "Mobilit√©", "Yoga doux"] },
  Dimanche: { title: "Repos total", ex: ["Hydratation", "Pr√©paration semaine", "Sieste üòå"] }
};

// ------------ g√©n√©ration du calendrier (r√©par√©) ------------
const calendar = document.getElementById('calendar');
const todayName = new Date().toLocaleDateString('fr-FR', { weekday: 'long' });
for (const [day, data] of Object.entries(programme)) {
  const d = document.createElement('div');
  d.className = 'day';
  d.innerHTML = `<h3>${day} <span style="font-size:.9em;opacity:.75;">${data.title}</span></h3>
                 <div class="day-details">
                   <ul>${data.ex.map(e=>`<li class="day-exercise">${e}</li>`).join('')}</ul>
                 </div>`;
  calendar.appendChild(d);
}
// toggle des details
calendar.addEventListener('click', (e)=>{
  const dayEl = e.target.closest('.day');
  if(!dayEl) return;
  const details = dayEl.querySelector('.day-details');
  const open = details.classList.contains('open');
  // close all
  document.querySelectorAll('.day-details').forEach(d=>d.classList.remove('open'));
  if(!open) details.classList.add('open');
});

// ------------ affichage s√©ance du jour + rendre les exos cliquables ------------
const sessionList = document.getElementById('session_list');
const title = document.getElementById('session_title');
const todayKey = todayName.charAt(0).toUpperCase() + todayName.slice(1);
const todayData = programme[todayKey];

function makeExerciseClickable(li, exName){
  li.addEventListener('click', ()=> openExercise(exName));
}

if(todayData){
  title.textContent = `üí™ S√©ance du jour (${todayData.title})`;
  todayData.ex.forEach(ex=>{
    const li = document.createElement('li');
    li.textContent = ex;
    sessionList.appendChild(li);
    makeExerciseClickable(li, ex);
  });
} else {
  title.textContent = "üòå Jour de repos / √©tirements";
  sessionList.innerHTML = "<li>Profite pour r√©cup√©rer et t‚Äô√©tirer !</li>";
}

// Also make calendar's inner exercise items clickable
document.querySelectorAll('.day-exercise').forEach(el=>{
  const exName = el.textContent;
  el.style.cursor = 'pointer';
  el.addEventListener('click', (ev)=>{
    ev.stopPropagation(); // prevent toggling day
    openExercise(exName);
  });
});

// ------------ navigation exercice ------------
function openExercise(exName){
  const exo = exerciseData[exName];
  if(!exo){
    alert("Aucune donn√©e disponible pour cet exercice (je peux en ajouter plus).");
    return;
  }
  document.getElementById("main_page").style.display = "none";
  const ep = document.getElementById("exercise_page");
  ep.classList.add("active");
  document.getElementById("exo_title").textContent = exName;
  document.getElementById("exo_video").src = exo.video;
  document.getElementById("exo_desc").textContent = exo.desc;
  document.getElementById("exo_tips").innerHTML = exo.tips.map(t=>`<li>üí° ${t}</li>`).join('');
  // Scroll to top for better UX
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
function goBack(){
  document.getElementById("exercise_page").classList.remove("active");
  document.getElementById("main_page").style.display = "block";
  document.getElementById("exo_video").src = "";
}

// ------------ progression & timer (inchang√©, fonctionnel) ------------
function markSessionDone(){ const today=new Date().toISOString().split('T')[0];let h=JSON.parse(localStorage.getItem('sessions_done')||'[]'); if(!h.includes(today)){ h.push(today); localStorage.setItem('sessions_done', JSON.stringify(h)); } updateProgress(); }
function updateProgress(){
  const h = JSON.parse(localStorage.getItem('sessions_done')||'[]');
  const today = new Date();
  const yearWeek = (d=>{ const oneJan=new Date(d.getFullYear(),0,1); const numberOfDays=Math.floor((d-oneJan)/(24*60*60*1000)); return Math.ceil((numberOfDays + oneJan.getDay()+1)/7); })(today);
  const weekSessions = h.filter(date=>{ const d = new Date(date); const week = (d=>{ const oneJan=new Date(d.getFullYear(),0,1); const numberOfDays=Math.floor((d-oneJan)/(24*60*60*1000)); return Math.ceil((numberOfDays + oneJan.getDay()+1)/7); })(d); return week === yearWeek; }).length;
  const weekProgress = Math.min((weekSessions/5)*100,100);
  document.getElementById('week_progress_bar').style.width = weekProgress+'%';
  document.getElementById('week_progress_text').textContent = `${weekSessions}/5 s√©ances`;

  const month = today.getMonth();
  const monthSessions = h.filter(date => new Date(date).getMonth() === month).length;
  const monthDays = new Date(today.getFullYear(), month+1,0).getDate();
  const monthProgress = Math.min((monthSessions/(monthDays/2))*100,100);
  document.getElementById('month_progress_bar').style.width = monthProgress+'%';
  document.getElementById('month_progress_text').textContent = `${monthSessions} s√©ances`;

  let streak = 0; let checkDate = new Date(today);
  while(h.includes(checkDate.toISOString().split('T')[0])){ streak++; checkDate.setDate(checkDate.getDate()-1); }
  document.getElementById('streak_value').textContent = streak;
}
updateProgress();

let timerInterval; let timerSeconds = parseInt(localStorage.getItem('timerSeconds')||'0'); const display = document.getElementById('timer_display');
function updateDisplay(){ let m=Math.floor(timerSeconds/60), s=timerSeconds%60; display.textContent = `${m<10?'0':''}${m}:${s<10?'0':''}${s}`; } updateDisplay();
function startTimer(){ if(timerInterval) return; timerInterval = setInterval(()=>{ timerSeconds++; localStorage.setItem('timerSeconds', timerSeconds); updateDisplay(); },1000); }
function stopTimer(){ clearInterval(timerInterval); timerInterval = null; }
function resetTimer(){ timerSeconds = 0; updateDisplay(); localStorage.removeItem('timerSeconds'); }
function reset(){ /* placeholder reset s√©ries possible */ alert("Reset s√©ries (√† impl√©menter selon ton UI de s√©ries)"); }

</script>
</body>
</html>
